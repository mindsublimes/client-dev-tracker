<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3 mb-0">Notifications</h1>
  <% if @unread_count > 0 %>
    <%= button_to 'Mark all as read', mark_all_read_notifications_path, method: :patch, class: 'btn btn-outline-primary btn-sm' %>
  <% end %>
</div>

<% if @notifications.any? %>
  <div class="card shadow-sm border-0">
    <div class="list-group list-group-flush">
      <% @notifications.each do |notification| %>
        <%= form_with url: notification_path(notification), method: :patch, local: true, class: 'd-inline w-100' do |f| %>
          <%= hidden_field_tag :redirect_to, agenda_item_path(notification.agenda_item) %>
          <button type="submit" class="list-group-item list-group-item-action text-start border-0 w-100 <%= 'bg-light' unless notification.read? %>">
            <div class="d-flex justify-content-between align-items-start">
              <div class="flex-grow-1">
                <div class="d-flex align-items-center gap-2 mb-2">
                  <span class="badge bg-<%= notification.notification_type == 'assigned' ? 'primary' : notification.notification_type == 'message' ? 'info' : 'warning' %>">
                    <%= notification.notification_type.titleize %>
                  </span>
                  <% unless notification.read? %>
                    <span class="badge bg-danger">New</span>
                  <% end %>
                </div>
                <div class="fw-semibold mb-1"><%= notification.message %></div>
                <div class="small text-muted">
                  <%= notification.agenda_item.title %> â€¢ <%= time_ago_in_words(notification.created_at) %> ago
                </div>
              </div>
            </div>
          </button>
        <% end %>
      <% end %>
    </div>
  </div>
<% else %>
  <div class="card shadow-sm border-0">
    <div class="card-body text-center py-5">
      <i class="bi bi-bell-slash text-muted" style="font-size: 3rem;"></i>
      <p class="text-muted mt-3 mb-0">No notifications</p>
    </div>
  </div>
<% end %>

